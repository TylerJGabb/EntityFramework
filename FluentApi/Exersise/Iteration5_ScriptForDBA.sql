DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'VidzyCodeFirst.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201804221759286_InitialModel'
BEGIN
    CREATE TABLE [dbo].[Genres] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Videos] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [ReleaseDate] [datetime] NOT NULL,
        CONSTRAINT [PK_dbo.Videos] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoGenres] (
        [Video_Id] [int] NOT NULL,
        [Genre_Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoGenres] PRIMARY KEY ([Video_Id], [Genre_Id])
    )
    CREATE INDEX [IX_Video_Id] ON [dbo].[VideoGenres]([Video_Id])
    CREATE INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]([Genre_Id])
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201804221759286_InitialModel', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400ED59DB6EE336107D2FD07F10F4D416592B9797AD61EF227592C2E8E6823809FA16D0D2D8214A512A4905768A7E591FFA49FD850E7517295972BA488BB60810C8E2DCE7703843FDF1DBEF938F9B9039CF20248DF8D43D1A1DBA0E703F0A285F4FDD44ADDEBD773F7EF8F28BC979106E9C8782EE44D321279753F749A978EC79D27F8290C851487D11C968A5467E147A2488BCE3C3C36FBDA3230F50848BB21C67729B704543487FE0CF59C47D885542D865140093F97B5C59A4529D2B12828C890F53F781062FDB19925D5021D52863709D5346091AB300B6721DC279A4884253C7F712164A447CBD88F1056177DB18906E459884DC8571453ED49BC363ED8D573116A2FC44AA28DC53E0D1491E1ECF647F5590DD327C18C0730CB4DA6AAFD3204EDDEF810BF4DCD4349E31A1A93A023C4AD90E9CE6E2418908048EFE3B70660953898029874409C20E9C9B64C9A8FF036CEFA29F804F79C258DD403411D71A2FF0D58D8862106A7B0BABDCEC79E03A5E93CF33194BB61A4FE6D39CAB9363D7B942E564C9A0CC7FCDFF858A04A097208882E0862805826B199046D0D26EE8D2FF0B6D0838DC3EAE7349369F80AFD5D3D4C547D7B9A01B088A37B905F79CE26E43262512B0945C9167BA4EED33D4611E2042D8DF024B97E5138D33F48FD2A5C7345F487021A2F03662054BFEFEF18E88352834386A595C4489F00D63265E85A49DF84A25ED8FAF94ED7F7CBD31BE0C2588262012CED0C242977EBEA35AB7E5DC50AC16507C2D560B38B662B500F210AC9E4A19F934B5A10ED6427FD39D731E38BB8CC932513A81D94064D218B1889AA7EE37567C3A04963BB1129897E89D02275ECD1B7B43E289AA0845B0558EBE6CCF96FA356C54CBF6C47332DFA132C78A69BD16BB006524B58A74D378CBF9267B51BF2CF63C98067BCD574346099E1A491BB8CC0AD093DED2DECA546FA08822A13511858D668169BAD582E0328D5547E4652D51D13A791DBDD3E492C43156895A2F95BF71165923357BB7D8BFBD0833199E2F5BBA8CD2DA5213D63CB20663155517051EAB0B59125D4C6641689119A0ED4054A1AC814B3B5705CE0A72FD5CDB1BED0D8F29A78AE2053A1662E94E7D0433D7365FDACB124644CB19328B5812F2AE73681777762AD4F9B337B6848967186E46C8B3426480D50CF8A074E49BE7AFA723AB0BFBA7A383EFEF4E479784C6095C17D45878FBF4362B554B8ECB3A3C289125756BBA5AB7902EB76D4DB051B9EDC80CCA7326AA2DDB3A32A5E23D6DCA8F8257DA940AD9D326F34CB193691D2D264909A5F288318E92495ED6FB6775ABCE6724AE83B63F63A0B0C62FB6524138D204A3C5CF6CC62882B722B8249CAE40AAACB97771563E1E9DBE24BAC3684CFCFF9CE9DB9332604346F0371F52A80E6CEF18D2D7E6EF984BF83311FE13115F8564F3755D923D7BEC394EFEA76335684E0BF059F5CF69FBC5FDD540DD514E6DE2AE3AD79FAF4A4D2D6BD66833E7016CA6EE2F29D3D899FFF858F01D38D7028BCCD839747EDD3B9B95D9FB292FF8F650FEBA81B6F54834A796FE49F6C83A89AFF91902508173EA67557646A44F023B62FA98DAA93D1F164D13860CC0FA16195620F45E240C4F33A9049E6756E3732328F7694C58C36BFB481E5241B44BA53C73E50C62E0BA34D80E0ED1B6AB0329451BE1ED0B40E725410F70DAFA965AEAECACB526EC5F069CE1A97C5BE0EC6A133F3B70DA6F97EC797EC0E551F7DD51D625E299B6D4E529AB8A1D5728ADF74ADDD74A6D92DBEF77DA2577195E5FECD4D1E142EFDD567929B5FB8AAB6302B20BBE351DF75E6D35DC36E7B4E1B75A839C2DAECF7A9C6D1FADEC2265DDCCBC95B37B5CE1D9F314EED0DA1752AC1092AE2B11FA7B2907BFB1374B9A395F454591302C2A488C46E61214C1F6919C0A4557C457B8EC8394E9278607C21224390F9710CCF975A2E244A1CB102E59E393852E35BBF4A7F7944D9B27D771FA35E073B8806652DD015FF3EF12CA82D2EE8B965EAA4384AE6179AFAF73A974CFBFDE9692AE223E50501EBEB2F4DE4118331426AFF9823CC36B6CBB97F009D6C4DF166371B790FE4434C33E39A3642D48287319153FFE440C07E1E6C39FECC109EC28200000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201804221801109_SeedGenres'
BEGIN
    INSERT INTO Genres (Name) VALUES ('Action')
    INSERT INTO Genres (Name) VALUES ('Horror')
    INSERT INTO Genres (Name) VALUES ('Comedy')
    INSERT INTO Genres (Name) VALUES ('Family')
    INSERT INTO Genres (Name) VALUES ('Drama')
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201804221801109_SeedGenres', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400ED59DB6EE336107D2FD07F10F4D416592B9797AD61EF227592C2E8E6823809FA16D0D2D8214A512A4905768A7E591FFA49FD850E7517295972BA488BB60810C8E2DCE7703843FDF1DBEF938F9B9039CF20248DF8D43D1A1DBA0E703F0A285F4FDD44ADDEBD773F7EF8F28BC979106E9C8782EE44D321279753F749A978EC79D27F8290C851487D11C968A5467E147A2488BCE3C3C36FBDA3230F50848BB21C67729B704543487FE0CF59C47D885542D865140093F97B5C59A4529D2B12828C890F53F781062FDB19925D5021D52863709D5346091AB300B6721DC279A4884253C7F712164A447CBD88F1056177DB18906E459884DC8571453ED49BC363ED8D573116A2FC44AA28DC53E0D1491E1ECF647F5590DD327C18C0730CB4DA6AAFD3204EDDEF810BF4DCD4349E31A1A93A023C4AD90E9CE6E2418908048EFE3B70660953898029874409C20E9C9B64C9A8FF036CEFA29F804F79C258DD403411D71A2FF0D58D8862106A7B0BABDCEC79E03A5E93CF33194BB61A4FE6D39CAB9363D7B942E564C9A0CC7FCDFF858A04A097208882E0862805826B199046D0D26EE8D2FF0B6D0838DC3EAE7349369F80AFD5D3D4C547D7B9A01B088A37B905F79CE26E43262512B0945C9167BA4EED33D4611E2042D8DF024B97E5138D33F48FD2A5C7345F487021A2F03662054BFEFEF18E88352834386A595C4489F00D63265E85A49DF84A25ED8FAF94ED7F7CBD31BE0C2588262012CED0C242977EBEA35AB7E5DC50AC16507C2D560B38B662B500F210AC9E4A19F934B5A10ED6427FD39D731E38BB8CC932513A81D94064D218B1889AA7EE37567C3A04963BB1129897E89D02275ECD1B7B43E289AA0845B0558EBE6CCF96FA356C54CBF6C47332DFA132C78A69BD16BB006524B58A74D378CBF9267B51BF2CF63C98067BCD574346099E1A491BB8CC0AD093DED2DECA546FA08822A13511858D668169BAD582E0328D5547E4652D51D13A791DBDD3E492C43156895A2F95BF71165923357BB7D8BFBD0833199E2F5BBA8CD2DA5213D63CB20663155517051EAB0B59125D4C6641689119A0ED4054A1AC814B3B5705CE0A72FD5CDB1BED0D8F29A78AE2053A1662E94E7D0433D7365FDACB124644CB19328B5812F2AE73681777762AD4F9B337B6848967186E46C8B3426480D50CF8A074E49BE7AFA723AB0BFBA7A383EFEF4E479784C6095C17D45878FBF4362B554B8ECB3A3C289125756BBA5AB7902EB76D4DB051B9EDC80CCA7326AA2DDB3A32A5E23D6DCA8F8257DA940AD9D326F34CB193691D2D264909A5F288318E92495ED6FB6775ABCE6724AE83B63F63A0B0C62FB6524138D204A3C5CF6CC62882B722B8249CAE40AAACB97771563E1E9DBE24BAC3684CFCFF9CE9DB9332604346F0371F52A80E6CEF18D2D7E6EF984BF83311FE13115F8564F3755D923D7BEC394EFEA76335684E0BF059F5CF69FBC5FDD540DD514E6DE2AE3AD79FAF4A4D2D6BD66833E7016CA6EE2F29D3D899FFF858F01D38D7028BCCD839747EDD3B9B95D9FB292FF8F650FEBA81B6F54834A796FE49F6C83A89AFF91902508173EA67557646A44F023B62FA98DAA93D1F164D13860CC0FA16195620F45E240C4F33A9049E6756E3732328F7694C58C36BFB481E5241B44BA53C73E50C62E0BA34D80E0ED1B6AB0329451BE1ED0B40E725410F70DAFA965AEAECACB526EC5F069CE1A97C5BE0EC6A133F3B70DA6F97EC797EC0E551F7DD51D625E299B6D4E529AB8A1D5728ADF74ADDD74A6D92DBEF77DA2577195E5FECD4D1E142EFDD567929B5FB8AAB6302B20BBE351DF75E6D35DC36E7B4E1B75A839C2DAECF7A9C6D1FADEC2265DDCCBC95B37B5CE1D9F314EED0DA1752AC1092AE2B11FA7B2907BFB1374B9A395F454591302C2A488C46E61214C1F6919C0A4557C457B8EC8394E9278607C21224390F9710CCF975A2E244A1CB102E59E393852E35BBF4A7F7944D9B27D771FA35E073B8806652DD015FF3EF12CA82D2EE8B965EAA4384AE6179AFAF73A974CFBFDE9692AE223E50501EBEB2F4DE4118331426AFF9823CC36B6CBB97F009D6C4DF166371B790FE4434C33E39A3642D48287319153FFE440C07E1E6C39FECC109EC28200000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201804221810019_ChangeVideoToHaveOneGenreOnly'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Videos_Video_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id]
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Video_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Video_Id] ON [dbo].[VideoGenres]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]
    ALTER TABLE [dbo].[Videos] ADD [Genre_Id] [int]
    CREATE INDEX [IX_Genre_Id] ON [dbo].[Videos]([Genre_Id])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id])
    DROP TABLE [dbo].[VideoGenres]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201804221810019_ChangeVideoToHaveOneGenreOnly', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400ED595B6FE344147E47E23F587E02D48DD3F66589925D95B44511DB8BEAB6E2AD9AD827E988F1D8CC8CABA4885FC6033F89BFC019DF3DE3244E600B1268A5553A73EEE79B7349FEF8EDF7F1C755C49C171092C67CE21E0F86AE033C8843CA971337558B77EFDD8F1FBEFC627C11462BE7B1A43BD574C8C9E5C47D562A19799E0C9E21227210D140C4325EA84110471E0963EF6438FCD63B3EF60045B828CB71C67729573482EC0FFC731AF300129512761587C064718E377E26D5B92611C8840430711F69F8BA9E22D92515520D7206D7396394A0313EB085EB10CE6345149A3A7A90E02B11F3A59FE00161F7EB04906E419884C285514DDED79BE189F6C6AB194B51412A551CED29F0F8B4088F67B21F1464B70A1F06F00203ADD6DAEB2C8813F77BE0023D37358DA64C68AA0D011E646C474EFBF2A842040247FF3B72A62953A98009875409C28E9CDB74CE68F003ACEFE39F804F78CA58D3403411EF5A0778742BE204845ADFC1A2307B16BA8ED7E6F34CC68AADC193FB34E3EAF4C475AE51399933A8F2DFF0DF57B100F412045110DE12A540702D03B2085ADA0D5DFAFF521B020E9F8FEB5C91D527E04BF53C71F1A3EB5CD21584E54961C103A7F8DA904989142C25D7E4852E33FB0C7598078811F677C0B26BF94C931CFD83ECEAA948F3A588A3BB98951CF9F1D33D114B50686E6CDFF9712A02C392B157C3682BB83241FB832B63FB1F5C6F0C2E43094209888473B4B0D4A53FDF53ADDB72AE2F500B1C1E86D3128B5D382D31DC07A76752C601CD0C6802B550DEF6E48287CE164BF21C54F6631E1093344114A2DE89FB8D15996E79D50BACE5159168CB1B0E06C7A68F0D6FECC788AD54118A40AB1D7D5D9FCFF531AC54C7D3C40659BC4E59E0C4B45F8BF54135138A95A78E74DB7ECBFD367B59B82CF6229C067BC3574346899C064507B0CCB7BF3DBB95B1B59D5E3F09653E1B12CA409985A5ED52077AAB14D6639097CF41E5BCE46D1898C6572449B03A3406A8E2C4F1F3E969FACEDF7FA68872195E203B468BCADA4A13D63AB204E3165597851DAB0A99135D44A66164911980DD80A652590B9376AA4A8C95E4FA73E35D744F39A69C3A8A97E85884253BF311CC5CDB7CD9004B18111DBD631AB334E29BFACF36EEBC1B34F9F3135BC2D8330C3723E4592132C06A06BC573A8AB7F3D7D391D784FDD3B181EF9F4EC72609ADCEDB14D4BA78FBF4B62B55478ECB1ADC2B8F2571AF64E932DB35F2B6CBAD1D915EF9CD6574655947A4D2BB9F49450F39D0A4BD8DC1FA18D26CA099493D9C5583591F47CD266467DFEA45264985BDAA2719BD675CF481DD1BBDD5187212D741DF5F30C2D814FCB554100D34C1C0FF994D1945B4D7045784D30548956F012E6ED42783B3D7341B0F9ADF0BFC7B76744FCA90F559D4DF7C9BA13AB03BF7955DFBC0960586BF10113C13F15544565F3725D94BCA9E7BE77F3A56BD16BA103FAB5E0B5DD71AF764786EED12331EC26AE2FE92318D9CD98F4F25DF917323F0A18E9CA1F3EB61393F6C876B34A8FDD62C7BD23F64F943A081D038200C2BA954026BA9D5A56F71A10F684258CB66BB91F441AF8E5F25CFBC398704B88665CBAD3E8AB675CC4AAAF18C76F9BEE7226BAF0F3DF6D4CD6B6ADE63F045CC756273306ED8D83A57D8CD1B6C97E4EE6DF2336EB72DEF1B2BCACE7DD65E823FCF066B4F078898C6AF0208564997B5083DF070085A58A968667C1197A0352C2A498C7A76058A6031246742D10509145E072065F6CDDA236129925C44730867FC265549AAD06588E6ACF54D9D86FE36FDD99ADEB6797C9364DF82FD1D2EA09954D7F31BFE5D4A5958D97D69D7F34D22F49B2A3A97CEA5D21D6CB9AE245DC7BCA7A0227C5529B8872861284CDE709FBCC021B63D48F8044B12ACCB216FB390DD8968877D7C4EC952904816326A7EFD4B97A77FEAFAF027E292612A1C1B0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201804221820519_AddClassificationColumnToVideoTable'
BEGIN
    ALTER TABLE [dbo].[Videos] ADD [Classification] [tinyint] NOT NULL DEFAULT 0
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201804221820519_AddClassificationColumnToVideoTable', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400ED59CD6EE33610BE17E83B083AB545D6B2934B1BD8BBC83AC9C2E83A09A224E82DA0A5B14394A254920AEC2DFA643DF491FA0A1DEA5FA4ECC86E765BA0C5020B8BE40CE7E79B3FE6CFDFFF18BF5B47CC79062169CC27EE6830741DE0411C52BE9AB8A95ABEF9DE7DF7F6EBAFC61761B4761ECA7327FA1C527239719F944A4E3D4F064F10113988682062192FD52088238F84B1773C1CFEE08D461E200B177939CEF836E58A46907DE0E734E601242A256C1E87C064B18E3B7EC6D5B92211C8840430711F68F86933C56397544835C8095CE78C5182C2F8C096AE43388F155128EAE9BD045F8998AFFC041708BBDB2480E7968449285438AD8FF7D56678ACB5F16AC29255904A15477B321C9D14E6F14CF2838CEC56E643035EA0A1D5466B9D1971E27E002E5073F3A6D32913FAD416030F32B223A7BD7954210281A3FF1D39D394A954C08443AA046147CE4DBA6034F8113677F1CFC0273C65AC29208A887BAD055CBA117102426D6E6159883D0B5DC76BD379266145D6A0C9759A717572EC3A5778395930A8FCDFD0DF57B100D412045110DE10A54070CD03320B5AB71B77E9FFCBDB1070183EAE3327EB8FC057EA69E2E24FD7B9A46B08CB9542827B4E31DA90488914AC4BAEC8335D65F219D7A11F2046D8DF02CBB6E5134D72F40FB2ADC7C2CD97228E6E635652E4CB8F7744AC40A1B8B1BDE7C7A9080C49C65E0DA39DE0CA18ED0FAE8CEC7F707D6170199720948048384709CBBBF4EF3BAAEFB694DBCD6BCA8894744983228B15A26B789A5B2F71DE1A0205C20F8B8012E55D11504647BF0848A306FE4DE566F29291555D6FF60D8C36BFD78A10C44508826D1047F9E5EF37E8F3B6D9E7102D40146AF994618BE03A0F84A5F839B29CD43AFD21666175F678F7D91BED3CB46175FEC4B67B6EE1E6E299947140339B34134FE1F2F675173C7476F8BF066691BBE668419AA0CDD0DB13F73B4BFC6E7E5546ADF915F86BF31B0E062353C386367672C5D64811CA2B836508385FE86558AB0E4461C353804A16716FCAAFD9FAA09A618495A4C6775B7E4BFD367959882CF2C29C06794357834719AF8D131DE16CE6F2DDDEAD84ADE5F4FA7128FDD9E0501ACA2C146D953A7246E5C2BAADF5F2BEB6EC7FBD2D0DF0784E9204A3B4D110172B8E9F77C3D337FEFE3D6294F3F002D9D12A56D2563761ED222B3076F1EA320D6195200BA2D3DB348CAC630660B7A0A9BCAC8549DB5525C6CAE3FA77232EBABB56934F6DC54B542CC2129CE908A6AF6DBA6C20218C888E5E601AB334E2DBFA895DD479756FD2E72B3687B167086E5AC8B34C6480D534782F7714B1F3F7DD91E784FDDDB185EE9F76C7360EAD4EAAC9A8B5D19F9FD95534599A7B5F1E34EDFCD7819C32B3F7424779B8170474F2EE1A8CDA49DCB6482FD4E43CBAB0A32D52DDBB9F4845653A50A4BD85C1AC1BD2AC4D9A49DD68578D681F45CDD2667BDFAA70E6910A7B55A5332ADAB8A82E2FBFFB58E5263FE23AA8FB335A184B8DBF910AA2813E30F07F61534611EDF58139E1740952E59DB07B3C1C1D0FCE3EA559D3D17C3DFAF7BCE4785286ACCF73CE179F79A936EC8B53ED9E536373CCE5CF44044F447C1391F5B74D4EF628BBE7EBC47FDA56BDC6FE107FABD71BFB71C0DB6436D8935B9D971A76B4E69D19CEB2EB89FB6B4674EACC7E7A2CE98E9C6B81617FEA0C9DDF0E43D0617366A3DCED370ADAD3C821032AC216844615619897A5129899AD9A7F23280F6842584B66BB2CF589056DBF8A9FB9730E09700DF2965A7D2EDA557F2BAE4650BEA4FB9EC3B63DE2F498A5B78FD279C5C2F85A68C7E660DC3255768ED9DBA7EC2ECEDD13EF679CC05BDA37C6A817676E7B50FF3C53B6DD6B20621A7F8942B04ABAAA59E8F68943D0C24A7566C69771095A43A2F28891CFE6A008A6567226145D9240E17600982FF56B6EF1FA75112D209CF1EB5425A94295215AB0D6EBB086FEAEFBB3A784B6CCE3EB247B1F7D0D15504CAAABC3357F9FD2C62BDFA59DCFB7B1D03155D441ED4BA5EBE16A5371BA8A794F4685F9AA54700751C29099BCE63E79864364BB97F0115624D8942DE376262F3BA26DF6F139252B412259F0A8E9F113311C46EBB77F0196D954FB901D0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201804250506555_Iteration4'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.Videos_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[Videos]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[Videos]
    EXECUTE sp_rename @objname = N'dbo.Videos.Genre_Id', @newname = N'GenreId', @objtype = N'COLUMN'
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var1 nvarchar(128)
    SELECT @var1 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'GenreId';
    IF @var1 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var1 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [GenreId] [int] NOT NULL
    CREATE INDEX [IX_GenreId] ON [dbo].[Videos]([GenreId])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_GenreId] FOREIGN KEY ([GenreId]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201804250506555_Iteration4', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400ED59DB6EE336107D2FD07F10F4D416592B76B0401BD8BBC83AC9C2E83A09A224E8DB8296C60E518A52492AB0B7E897F5A19FD45FE850374BA4E4DB26DB0B8A00814DCE8D33678633F49FBFFF317CBB8C98F30442D2988FDC7EEFD87580077148F962E4A66AFEEA7BF7ED9BAFBF1A5E84D1D27928E94E341D727239721F954A4E3D4F068F1011D98B68206219CF552F88238F84B137383EFEC1EBF73D40112ECA729CE16DCA158D20FB825FC7310F20512961D33804268B75DCF133A9CE15894026248091FB40C34FAB31925D5221552F67709D3346091AE3039BBB0EE13C5644A1A9A7F7127C2562BEF0135C20EC6E9500D2CD0993501CE1744DBEEB698E07FA34DE9AB11415A452C5D19E02FB27857B3C93FD2027BB95FBD08117E868B5D2A7CE9C3872DF0317787253D3E998094DD5E1E05EC676E434378F2A442070F4DF91334E994A058C38A44A1076E4DCA43346831F617517FF0C7CC453C6EA06A289B8D758C0A51B112720D4EA16E685D993D075BC269F6732566C359EFC4C13AE4E06AE7385CAC98C4115FFDAF97D150BC05382200AC21BA21408AE6540E6414BBBA14BFF2FB521E0307D5C674A961F802FD4E3C8C58FAE73499710962B8505F79C62B621931229584AAEC8135D64F619EA300E1023EC6F8165DBF2912639FA7BD9D6C722CC97228E6E635672E4CB1FEF8858804273637BCF8F531118960CBD358C36822B13B43FB832B6FFC17528B806AF5FEF042ECBC2CD5A115B40249CA3C9A572FDF98E46FBCBCAB0B5DD659B858C199192CE6950D4C6C2211AF4E6D636C99D8955E4CD617955E64E5B5E9539B75B5EA5512DABCCC34DE425238BF52DB66FBA35E53D57DE21DA42106C85E8CC95BF5B21709A6E9F423403511CCBA70C1B0FD779202CC5AF7D2B480DEAF7310B2BDAC166DA1B1D3CF461457F62FB3DF7707DF14CCA38A0994FEAE5AC087953DD050F9D0DF15F03B3A88853F4204DD06718ED91FB9D657EBBBCAA4EAFE515F86BCAEBBB668DBBE6E798BD0A9CB3206F43C6440624B413013D113657B02C82D0758930ECCB24069C7265D750CA039A10D66DB5C1B263E1D52655C2CD9D734880EB9AD9EDFB5DB456C5C8565D6930BCB4CD2943AF861EFB8A441E851C1540B38C3B9FE96558AA960CC6B6B5486259546F132F5AAC0FAA7E24EC07D6F5A489170B6E4DF6B29DB0D80BF81AECB5B31A32CAFA58A368299FA6DB37675365ECDA4E2B709BF3A726A174949906CD23B5D4E82A84EBE1C4CBA793728AF13AC698E194240956C5DA5853AC387E3ED38C5FF9FB77FA512EC30B644BC35F595B69C20E842CC0D845D565D9C7AB9DCC88BE4EC66164911980ED4053A9AC81493B5425C64A72FDB99617EDB3474B6617FC9778B0481785ACCB32636DF36563256144B47474E398A511EF2E4EDDDC798F56E7CF576C0943CF30DCAA42968BAC9ADD74F84EE12872E7F3C391D784FDC3D1C1F77787A34B42A3FDAD0B6A6CEC2EAFBA75EAB23AAFA26E396637581767EE7D61F059B5D224A9B45735D3A88DC3A24E6D7F07B20A574EE23AE8AE27441A162D7F2515443D4DD0F37F616346F1BC6B8229E1740E52E53DAC3B38EE0F7A679FD2ECFAAABF26FD735E763C2943B6CBF3CE179F81A976ECD62977CF79AF3EF6F22722824722BE89C8F2DBBA24FBDD64CFD78AFFAEAFEC4782CF7F0108F1B37A861780CC0956DB3BC1DE7B39727FCD784E9DC94F1F0BB623E75A60CA9E3AC7CE6FCFF46E8013E22AB362A3B42E301D362C16DDF1179DE78CD6F890E9F4A091B0AB6B7B9929F05F32F8D9EDF60E735DF75897DF799895331DD71CC41D134EEBC8D73DF1B5496E9FBE5E701A6C9CBED6D26F9DFFECA1F165263EBB5B41C4D47EDB42AC4ABA588BD0BF7471081A58A968267C1E9798352C2A498CC2360545B0209333A1E89C040AB703C052A7DF878B97AF8B6806E1845FA72A49151E19A2196BBC376BE86FD29F8DB54D9B87D749F636FA1C474033A9BE53AEF9BB94D65EF82E5B4A7187089D53C54DAA63A9F48DBA585592AE62BEA3A0C27D5529B8832861284C5E739F3CC121B6DD4BF8000B12ACCAA6B35BC8F64034DD3E3CA7642148240B196B7EFC8A180EA3E59BBF00355AB3C6E21D0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '201804250517094_Iteration5'
BEGIN
    CREATE TABLE [dbo].[Tags] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Tags] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoTags] (
        [VideoId] [int] NOT NULL,
        [TagId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoTags] PRIMARY KEY ([VideoId], [TagId])
    )
    CREATE INDEX [IX_VideoId] ON [dbo].[VideoTags]([VideoId])
    CREATE INDEX [IX_TagId] ON [dbo].[VideoTags]([TagId])
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Videos_VideoId] FOREIGN KEY ([VideoId]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Tags_TagId] FOREIGN KEY ([TagId]) REFERENCES [dbo].[Tags] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201804250517094_Iteration5', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400ED5A6D6FDB3610FE3E60FF41D0A76D48ADBCA0C016D82D52272982352F88D362DF0A5AA21D6214E589546077D82FDB87FDA4FD851D254A96F8224B8E93764551A08849DEF178F7DC1D79A77FFFFE67F87A1953EF01A79C246CE41F0CF67D0FB33089089B8FFC4CCC5EFCECBF7EF5FD77C3B3285E7A1FCA7547721D50323EF2EF85581C07010FEF718CF82026619AF0642606611207284A82C3FDFD5F82838300030B1F7879DEF0366382C438FF013FC7090BF14264885E2611A65C8DC3CC24E7EA5DA118F3050AF1C8FF40A24FAB312C3B2729178382C0F74E284120CC04D399EF21C6128104887AFC9EE3894813369F2C6000D1BBD502C3BA19A21CAB231CAF97773DCDFEA13C4DB0262C5985191749DC93E1C191524FA0936FA564BF521F28F00C142D56F2D4B91247FE5BCC5238B9BED3F198A6729543C1839C6CCF6B4EEE558800E0C87F7BDE38A3224BF188E14CA488EE7937D99492F057BCBA4B7EC76CC4324AEB02828830D71880A19B3459E054AC6EF14C897D11F95ED0A40B74C28AAC46539CE98289A343DFBB82CDD194E2CAFEB5F34F44926238254E91C0D10D1202A74CF2C0B9068DDDB5BDE4FFE56E0038701FDFBB44CB7798CDC5FDC8873F7DEF9C2C71548E2809DE3302DE064422CDB0B1C9157A20F35C3E6D3BB0034E00F6B798E6D3FC9E2C0AF40FF2A98FCACCE76912DF26B4A428863FDEA1748E05889B987393244B434D9261B086512BB87246FDC195937D03D7B6E03A7CF9B213B80C09DB77056C61C4F129885C6E2EFFBE23717F5E39B636ABAC9DC99822CEC98C842A362A8548D0EB539B383B1D4BF9CD767E55FA8ECDAF4A9FEB2AC81D9AB7F97731AD8B21471D52E45336213A3B3770E8EFDA40F4CDB1B775EC67CF1A2DA8B2E78C06E0BAA12A8B6B98D2FDF6829F5360591DB42FDC9AFC76853CD0778453BA02FB149BBF59414C6C2AFD12C7539CAA634D08853BB5EF7D4034839F0786891AABDF2634AAD61EB6AFBD9196031D56EB8F4CBD171AAE0F9E709E8424D7491D0A2A9A35B73B6391D712DAD6315725FB4BD0205980CEC0DA23FF27437C3BBF0A4E6B7E2AB436F91DF8BA975FB353484C027B276171C31E231EA2C87403D044D41C81C08053E99988C2938383C109136614212C240B44DD526B241D438F14A962AECF9CE20566326AB875DF65D72ACF9A5B573B685ADAA4946150434F1750E541A41D03CD3CF568483503D49A5D9EB15A99390F57442F5088007554DE978793D3A91CC64B61094FF0DC54118AABE0AC4B2ED94EB0A8DB0B42EE3A58369DC1387893BC0CE806B952E406F222DC1BC4B9DA34D29A9AB4EDCB2B516D85E5C6A4C3B13DCA5482AE8F6800BA3DAED438943AD6C343F3489D8F5B28CD755A13FC9BE0BFCD591B80AF312864EB7CD0324957305F175E82A2F2525668024789667889160B488BB5928D1AF12645BD66FC62D2BF8A11173C82905B8A1995B4D54E70094373ACCDC2D665DE87670B9A22799F1847B1B14C736A87CB949B35FCD6B453E94AE572F9772D76D8EB2A96D0AEE8CFE160B1CC0AF9455307B5499797CC1045A9E5523B4E6816337776725317D7D43A7D31627218069AE0461A32546424EDA6C23B994339CEE3CD51C4CDFEE670D07D6E73B838349EF675468D89EEFCAA6B479D97F32EE2E6A33F07EAECF4B92F067C8E90DF177A32EBF6079E95EA73C3EEA90DD14C689650A09274276F576BAD1E6DD1AECCC5B6677523A99B1AE9648F9C91FDF65EDBB59740CE174B278180453F71F4CB86693EE3CEA12FA9C053DD3DB43BC650E5FBCDBD22E302502CF13D90FD017404C97FB2E202C703B96030F9838E2901B8AE175C224666988BA218E01FEE1F1C0E4E3E65F97DB7DE71FA72BA3F01E711EDD2027AF6721A918ADD5830EB5913AE57D0D8034AC37B94FE10A3E58F754E6695AC6747E3EBD595D948787C972082BFC50EBA04B9128C27F6058BF072E4FF99D31C7B17BF7D54647BDE750A2E7BECED7B7FEDA8B720085BE552B472EB5541FF7AA1B473B7DB525DEE2C6AAEB526B8CDDAADB6E8075445F628A02A89FB6D9C13F5D8D665A7EDEAC8AA40F4ACA55EAD62B24D9571AB6AB1EB3DFF3405E2FF554DD87A39EE6FA8A784495EF9D405D85C457E546BE1D9C0627F60F6899FCF8C17DBDBA56631DD58163B7D4558E96ABDE7448AF379B8739CD8DB316681D751B0697EDCE16AB614AF43B8BF4E65182A92A3A379606DC4B8FB3036CEF662BFAD47E36AD1D8B85A3B005669ED8CD7534E99AD5B3C5D7FA861B45AED7B6397C46CADECB407543570DA5A418E82507F511DF1C756B0DAE921CB2653EB21ED45263D546B55CBE738608F06975954827055FB4C19222527F3350BF9D132C3612350556B2ED82C29C3A52651B944BBD65F6281E0DD8C4E5241662814301D627891CA2F82D4971E67F1144717EC3A138B4CC091713CA58D2F8C64DC6DDB3FEFE235651E5E2FF20F817671041093C8A7FF357B9391DA172DE796F78583850CE8EA952A6D29E46B75BEAA385D25AC2323A5BE2A0FDDE178418119BF6613F480B791ED3DC7EFF01C85ABB236E866B2D9104DB50F4F099AA728E68AC79A1E7E0286A378F9EA3F46EDFEBDAD2F0000 , N'6.2.0-61023')
END

